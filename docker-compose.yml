version: "3.8"

services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile
    image: solidev-backend:latest
    container_name: solidev-backend
    env_file:
      - ./.env
    environment:
      - NODE_ENV=production
      - BIND=0.0.0.0
      # Recomiendo fijar SSL para asegurar rutas:
      - SSL_ENABLE=true
      - SSL_KEY_PATH=/app/key.pem
      - SSL_CERT_PATH=/app/cert.pem
    ports:
      - "${HTTP_PORT:-3002}:${HTTP_PORT:-3002}"
    volumes:
      # Montaje robusto con rutas absolutas (Windows):
      - type: bind
        source: d:/GitHubRepositorios/Solidev-pag/key.pem
        target: /app/key.pem
        read_only: true
      - type: bind
        source: d:/GitHubRepositorios/Solidev-pag/cert.pem
        target: /app/cert.pem
        read_only: true
    restart: always